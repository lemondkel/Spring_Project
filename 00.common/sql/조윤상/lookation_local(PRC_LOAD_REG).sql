SELECT USER
FROM DUAL;

-- 충전신청내역

SELECT * 
FROM LOAD_REG
WHERE MEMBER_CODE = 'M000001';
--==>>
/*
LR000001	M000001	170000	2020-11-01
LR000002	M000001	150000	2020-11-21
LR000003	M000001	130000	2020-12-04
LR000006	M000001	210000	2020-12-31
*/

-- 충전신청계좌정보


SELECT *
FROM LOAD_REG_BANK_INFO;
--==>>
/*
LRBI000001	LR000001	110-343-936673
LRBI000002	LR000002	110-343-936673
LRBI000003	LR000003	110-343-936673
LRBI000004	LR000004	554602-04-076182
LRBI000005	LR000005	545777-48488-76182
LRBI000006	LR000006	1002-048-273134
*/

-- 충전 신청시 충전신청내역 테이블과 충전신청계좌정보 테이블에 데이터가 추가되어야 한다.
-- 충전 신청 프로시저
CREATE OR REPLACE PROCEDURE PRC_LOAD_REG
( V_MEMBER_CODE         IN  VARCHAR
, V_MEMBER_BANK_NUMBER  IN  VARCHAR
, V_LOAD_AMOUNT         IN  NUMBER
)
IS

V_LR_SEQ VARCHAR2(20) := F_CODE('LR', LR_SEQ.NEXTVAL);

BEGIN

INSERT INTO LOAD_REG(LOAD_REG_CODE, MEMBER_CODE, LOAD_AMOUNT, LOAD_REG_DATE)
VALUES(V_LR_SEQ, V_MEMBER_CODE, V_LOAD_AMOUNT, SYSDATE);
-- 예외처리

INSERT INTO LOAD_REG_BANK_INFO(LOAD_REG_BANK_INFO_CODE, LOAD_REG_CODE, MEMBER_BANK_NUMBER)
VALUES(F_CODE('LRBI', LRBIF_SEQ.NEXTVAL), V_LR_SEQ, V_MEMBER_BANK_NUMBER); 
-- 예외처리

-- 커밋
COMMIT;

END;






